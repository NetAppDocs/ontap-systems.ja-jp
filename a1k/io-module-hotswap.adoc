---
permalink: a1k/io-module-hotswap.html 
sidebar: sidebar 
keywords: aff a1k, hot swap a cluster ha card, hot swap ethernet client io module, hotswap io module, hot swap io module 
summary: モジュールに障害が発生し、ストレージ システムがすべてのONTAPバージョン要件を満たしている場合は、AFF A1K ストレージ システム内の Ethernet I/O モジュールをホットスワップできます。 
---
= I/OモジュールのホットスワップAFF A1K
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
モジュールに障害が発生し、ストレージ システムがすべてのONTAPバージョン要件を満たしている場合は、AFF A1K ストレージ システム内の Ethernet I/O モジュールをホットスワップできます。

I/O モジュールをホットスワップするには、ストレージ システムで ONTAP 9.18.1 GA 以降が実行されていることを確認し、ストレージ システムと I/O モジュールを準備し、障害のあるモジュールをホットスワップし、交換用モジュールをオンラインにして、ストレージ システムを通常の動作に復元し、障害のあるモジュールをNetAppに返却します。

.このタスクについて
* 障害が発生した I/O モジュールを交換する前に手動でテイクオーバーを実行する必要はありません。
* ホット スワップ中に、正しいコントローラと I/O スロットにコマンドを適用します。
+
** _障害のあるコントローラ_ は、I/O モジュールを交換するコントローラです。
** _正常なコントローラ_ は、障害のあるコントローラの HA パートナーです。


* ストレージシステムの位置情報（青色）LEDを点灯させることで、影響を受けたストレージシステムの物理的な位置を特定しやすくなります。SSHを使用してBMCにログインし、 `system location-led _on_`コマンドを入力してください。
+
ストレージ システムには、オペレータ ディスプレイ パネルに1つ、各コントローラに1つ、合計3つのロケーションLEDが搭載されています。LEDは30分間点灯し続けます。

+
無効にするには、コマンドを入力し `system location-led _off_`ます。LEDが点灯しているか消灯しているかが不明な場合は、コマンドを入力してLEDの状態を確認できます `system location-led show`。





== ステップ1: ストレージシステムが手順の要件を満たしていることを確認する

この手順を使用するには、ストレージ システムでONTAP 9.18.1 GA以降が実行されており、ストレージ システムがすべての要件を満たしている必要があります。


NOTE: ストレージ システムでONTAP 9.18.1 GA以降が実行されていない場合は、この手順は使用できません。link:io-module-replace.html["I/Oモジュールの交換手順"]を使用する必要があります。

* クラスタ、HA、クライアントで使用されるポートの組み合わせが任意のスロットにあるイーサネットI/Oモジュールを、同等のI/Oモジュールとホット スワップしています。I/Oモジュールのタイプを変更することはできません。
+
ストレージまたはMetroClusterに使用されるポートを持つEthernet I/Oモジュールはホットスワップ対応ではありません。

* ストレージ システム（スイッチレスまたはスイッチ クラスタ構成）には、ストレージ システムでサポートされる任意の数のノードを含めることができます。
* クラスタ内のすべてのノードは、同じONTAPバージョン（ONTAP 9.18.1GA以降）を実行しているか、同じONTAPバージョンの異なるパッチ レベルを実行している必要があります。
+
クラスタ内のノードが異なるONTAPバージョンを実行している場合、これは混合バージョンのクラスタと見なされ、I/Oモジュールのホットスワップはサポートされません。



* ストレージ システム内のコントローラは、次のいずれかの状態になります：
+
** 両方のコントローラが起動して I/O（データの提供）を実行できます。
** テイクオーバーが障害が発生した I/O モジュールによって発生し、ノードがその他の点では正常に機能している場合、いずれかのコントローラが自動テイクオーバー状態になることがあります。
+
特定の状況では、ONTAPは、障害が発生したI/Oモジュールが原因で、いずれかのコントローラの自動テイクオーバーを実行できます。たとえば、障害が発生したI/Oモジュールにすべてのクラスタポートが含まれている場合（そのコントローラ上のすべてのクラスタリンクがダウンしている場合）、ONTAPは自動的にテイクオーバーを実行します。





* ストレージシステムの他のすべてのコンポーネントが正常に動作している必要があります。正常に動作していない場合は、この手順を続行する前にににお問い合わせください https://mysupport.netapp.com/site/global/dashboard["ネットアップサポート"]。




== ステップ2：ストレージシステムとI/Oモジュールスロットを準備する

障害が発生した I/O モジュールを安全に取り外せるように、ストレージ システムと I/O モジュール スロットを準備します：

.手順
. 自身の適切な接地対策を行います
. ケーブルの出元を識別するためにケーブルにラベルを付け、対象の I/O モジュールからすべてのケーブルを取り外します。
+
[NOTE]
====
I/O モジュールは障害状態（ポートはリンク ダウン状態）にあるはずですが、リンクがまだアップ状態であり、そこに機能している最後のクラスタ ポートが含まれている場合は、ケーブルを取り外すと自動テイクオーバーがトリガーされます。

この手順を続行する前に、ケーブルを外してから5分間待って、テイクオーバーまたはLIFフェイルオーバーが完了していることを確認してください。

====
. AutoSupportが有効になっている場合は、AutoSupportメッセージを呼び出してケースの自動作成を停止します。
+
`system node autosupport invoke -node * -type all -message MAINT=<number of hours down>h`

+
たとえば、次のAutoSupportメッセージは、自動ケース作成を 2 時間抑制します。

+
`node2::> system node autosupport invoke -node * -type all -message MAINT=2h`

. パートナー ノードがテイクオーバーされている場合は、自動ギブバックを無効にします：
+
[cols="1,2"]
|===
| 状況 | 作業 


 a| 
どちらかのコントローラが自動的にパートナー コントローラを引き継いだ場合
 a| 
自動ギブバックを無効にする:

.. パートナーを引き継いだコントローラのコンソールから次のコマンドを入力します：
+
`storage failover modify -node local -auto-giveback false`

.. 入力 `y`「自動ギブバックを無効にしますか?」というプロンプトが表示されたら、




 a| 
両方のコントローラが起動し、I/O（データの提供）を実行しています
 a| 
次の手順に進みます。

|===
. 障害が発生した I/O モジュールをサービスから削除し、電源をオフにして、取り外す準備をします：
+
.. 次のコマンドを入力します。
+
`system controller slot module remove -node _impaired_node_name_ -slot _slot_number_`

.. 入力 `y`「続行しますか?」というプロンプトが表示されたら
+
たとえば、次のコマンドは、ノード 2（障害のあるコントローラ）のスロット 7 にある障害のあるモジュールを取り外す準備をし、安全に取り外せることを示すメッセージを表示します：

+
[listing]
----
node2::> system controller slot module remove -node node2 -slot 7

Warning: IO_2X_100GBE_NVDA_NIC module in slot 7 of node node2 will be powered off for removal.

Do you want to continue? {y|n}: y

The module has been successfully removed from service and powered off. It can now be safely removed.
----


. 障害が発生した I/O モジュールの電源がオフになっていることを確認します：
+
`system controller slot module show`

+
出力には、障害が発生したモジュールとそのスロット番号の `_status_`列に `_powered-off_`が表示されます。





== ステップ3：故障したI/Oモジュールをホットスワップする

障害が発生した I/O モジュールを同等の I/O モジュールとホット スワップします。

.手順
. 接地対策がまだの場合は、自身で適切に実施します。
. ケーブルマネジメントトレイの内側にあるボタンを引いて下に回転させ、ケーブルマネジメントトレイを下に回転させます。
. I/Oモジュールをコントローラモジュールから取り外します。
+

NOTE: 次の図は、水平および垂直のI/Oモジュールの取り外しを示しています。通常は、I/Oモジュールを1つだけ取り外します。

+
image::../media/drw_a1k_io_remove_replace_ieops-1382.svg[I/Oモジュールの取り外し]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["番号1"]
 a| 
カムロックボタン

|===
+
.. カムラッチボタンを押します。
.. カムラッチをモジュールからできるだけ離します。
.. カムレバーの開口部に指をかけ、モジュールをコントローラモジュールから引き出して、モジュールをコントローラモジュールから取り外します。
+
I/O モジュールがどのスロットにあったかを記録します。



. I/O モジュールを脇へ置きます。
. 交換用I/Oモジュールをターゲットスロットに取り付けます。
+
.. I/O モジュールをスロットの端に合わせます。
.. モジュールをスロットにゆっくりとスライドしてコントローラモジュールに最後まで挿入し、カムラッチを上に回転させてモジュールを所定の位置にロックします。


. I/Oモジュールをケーブル接続します。
. ケーブルマネジメントトレイを回転させてロック位置にします。




== ステップ4：交換用I/Oモジュールをオンラインにする

交換用 I/O モジュールをオンラインにして、I/O モジュール ポートが正常に初期化されたことを確認し、スロットの電源がオンになっていることを確認してから、I/O モジュールがオンラインで認識されていることを確認します。

.このタスクについて
I/O モジュールが交換され、ポートが正常な状態に戻ると、LIF は交換された I/O モジュールにリバートされます。

.手順
. 交換用 I/O モジュールをオンラインにします：
+
.. 次のコマンドを入力します。
+
`system controller slot module insert -node _impaired_node_name_ -slot _slot_number_`

.. 入力 `y`「続行しますか?」というプロンプトが表示されたら、
+
出力により、I/O モジュールが正常にオンラインになったこと（電源がオンになり、初期化され、サービスが開始されたこと）が確認されます。

+
たとえば、次のコマンドは、ノード2（障害のあるコントローラ）のスロット7をオンラインにし、プロセスが成功したことを示すメッセージを表示します：

+
[listing]
----
node2::> system controller slot module insert -node node2 -slot 7

Warning: IO_2X_100GBE_NVDA_NIC module in slot 7 of node node2 will be powered on and initialized.

Do you want to continue? {y|n}: `y`

The module has been successfully powered on, initialized and placed into service.
----


. I/O モジュールの各ポートが正常に初期化されたことを確認します：
+
.. 障害のあるコントローラのコンソールから次のコマンドを入力します。
+
`event log show -event \*hotplug.init*`

+

NOTE: 必要なファームウェアの更新とポートの初期化には数分かかる場合があります。

+
出力には、1 つ以上の hotplug.init.success EMS イベントと `_hotplug.init.success:_`列の `_Event_`が表示され、I/O モジュール上の各ポートが正常に初期化されたことを示します。

+
たとえば、次の出力は、I/O ポート e7b と e7a の初期化が成功したことを示しています：

+
[listing]
----
node2::> event log show -event *hotplug.init*

Time                Node             Severity      Event

------------------- ---------------- ------------- ---------------------------

7/11/2025 16:04:06  node2      NOTICE        hotplug.init.success: Initialization of ports "e7b" in slot 7 succeeded

7/11/2025 16:04:06  node2      NOTICE        hotplug.init.success: Initialization of ports "e7a" in slot 7 succeeded

2 entries were displayed.
----
.. ポートの初期化に失敗した場合は、EMS ログを確認して次の手順を実行してください。


. I/O モジュール スロットの電源がオンになっていて、操作の準備ができていることを確認します：
+
`system controller slot module show`

+
出力にはスロットのステータスが `_powered-on_`と表示され、I/O モジュールの操作準備が完了していることがわかります。

. I/O モジュールがオンラインで認識されていることを確認します。
+
障害のあるコントローラのコンソールから次のコマンドを入力します。

+
`system controller config show -node local -slot _slot_number_`

+
I/O モジュールが正常にオンラインになり、認識された場合、出力にはスロットのポート情報を含む I/O モジュール情報が表示されます。

+
たとえば、スロット 7 の I/O モジュールの場合、次のような出力が表示されます：

+
[listing]
----
node2::> system controller config show -node local -slot 7

Node: node2
Sub- Device/
Slot slot Information
---- ---- -----------------------------
   7    - Dual 40G/100G Ethernet Controller CX6-DX
                  e7a MAC Address: d0:39:ea:59:69:74 (auto-100g_cr4-fd-up)
                          QSFP Vendor:        CISCO-BIZLINK
                          QSFP Part Number:   L45593-D218-D10
                          QSFP Serial Number: LCC2807GJFM-B
                  e7b MAC Address: d0:39:ea:59:69:75 (auto-100g_cr4-fd-up)
                          QSFP Vendor:        CISCO-BIZLINK
                          QSFP Part Number:   L45593-D218-D10
                          QSFP Serial Number: LCC2809G26F-A
                  Device Type:        CX6-DX PSID(NAP0000000027)
                  Firmware Version:   22.44.1700
                  Part Number:        111-05341
                  Hardware Revision:  20
                  Serial Number:      032403001370
----




== ステップ5: ストレージシステムを通常の動作に復元する

引き継がれたコントローラにストレージを戻し（必要に応じて）、自動ギブバックを復元し（必要に応じて）、LIF がホーム ポートにあることを確認し、AutoSupport 自動ケース作成を再度有効にして、ストレージ システムを通常の動作に復元します。

.手順
. ストレージ システムで実行されている ONTAP のバージョンとコントローラの状態に応じて、必要に応じて、テイクオーバーされたコントローラでストレージをギブバックし、自動ギブバックを復元します：
+
[cols="1,2"]
|===
| 状況 | 作業 


 a| 
どちらかのコントローラが自動的にパートナー コントローラを引き継いだ場合
 a| 
.. ストレージを戻して、テイクオーバーされたコントローラを通常の動作に戻します：
+
`storage failover giveback -ofnode _controller that was taken over_name_`

.. 引き継がれたコントローラのコンソールから自動ギブバックをリストアします。
+
`storage failover modify -node local -auto-giveback _true_`





 a| 
両方のコントローラが起動し、I/O（データの提供）を実行しています
 a| 
次の手順に進みます。

|===
. 論理インターフェイスがホーム ノードとポートにレポートしていることを確認します： `network interface show -is-home false`
+
いずれかのLIFがfalseと表示された場合は、ホームポートにリバートします。 `network interface revert -vserver * -lif *`

. AutoSupportが有効になっている場合は、ケースの自動作成をリストアします。
+
`system node autosupport invoke -node * -type all -message MAINT=end`





== 手順 6 ：障害が発生したパーツをネットアップに返却する

障害が発生したパーツは、キットに付属のRMA指示書に従ってNetAppに返却してください。 https://mysupport.netapp.com/site/info/rma["パーツの返品と交換"]詳細については、ページを参照してください。
