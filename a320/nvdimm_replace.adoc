---
permalink: a320/nvdimm-replace.html 
sidebar: sidebar 
keywords: aff, a320, aff a320, replace, nvdimm, controller, module, system, register, flash, lifetime, identified, idenify, nvdimm, healthy, general, failure, system, panic, replace an nvdimm, shut down the impaired controller, remove the controller module, replace the nvdimm, install the controller module, run diagnostics, restore the controller module to operation after running diagnostics, complete the replacement process 
summary: フラッシュの有効期間がほぼ終了していること、または識別された NVDIMM が全般的に正常でないことがシステムで登録された場合は、コントローラモジュールの NVDIMM を交換する必要があります。そのままにしているとシステムがパニック状態になります。 
---
= NVDIMM を交換します - AFF A320
:icons: font
:imagesdir: ../media/


[role="lead"]
フラッシュの有効期間がほぼ終了していること、または識別された NVDIMM が全般的に正常でないことがシステムで登録された場合は、コントローラモジュールの NVDIMM を交換する必要があります。そのままにしているとシステムがパニック状態になります。

システムのその他のコンポーネントがすべて正常に動作している必要があります。問題がある場合は、必ずテクニカルサポートにお問い合わせください。

障害が発生したコンポーネントは、プロバイダから受け取った交換用 FRU コンポーネントと交換する必要があります。



== 障害のあるコントローラをシャットダウンします

[role="lead"]
ストレージシステムのハードウェア構成に応じた手順を使用して、障害のあるコントローラをシャットダウンまたはテイクオーバーできます。



=== ノードをシャットダウン

[role="lead"]
障害ノードをシャットダウンするには、ノードのステータスを確認し、必要に応じて正常なノードが障害ノードのストレージからデータを引き続き提供できるようにノードをテイクオーバーする必要があります。

ノードが 3 つ以上あるクラスタは、クォーラムを構成している必要があります。クラスタがクォーラムを構成していない場合や、正常なノードの資格と健全性に false と表示される場合は、障害ノードをシャットダウンする前に問題を修正する必要があります。

http://docs.netapp.com/ontap-9/topic/com.netapp.doc.dot-cm-sag/home.html["ONTAP 9 システムアドミニストレーションリファレンス"]

.手順
. AutoSupport が有効になっている場合は、 AutoSupport メッセージを呼び出してケースの自動作成を抑制します。「 system node AutoSupport invoke -node * -type all -message MAINT=number_OF_hours_downh
+
次の AutoSupport メッセージは、ケースの自動作成を 2 時間停止します。 cluster1 ： * > system node AutoSupport invoke -node * -type all -message MAINT=2h`

. 正常なノードのコンソールから自動ギブバックを無効にします。「 storage failover modify – node local-auto-giveback false
. 障害ノードに LOADER プロンプトを表示します。
+
[cols="1,2"]
|===
| 障害ノードの表示 | 作業 


 a| 
LOADER プロンプト
 a| 
次の手順に進みます。



 a| 
ギブバックを待っています
 a| 
Ctrl キーを押しながら C キーを押し ' プロンプトが表示されたら y と入力します



 a| 
システムプロンプトまたはパスワードプロンプト（システムパスワードの入力）
 a| 
障害ノードをテイクオーバーまたは停止します。

** HA ペアの場合は、正常なノードから障害ノードをテイクオーバーします。「 storage failover takeover -ofnode impaired_node_name _
+
障害ノードに「 Waiting for giveback... 」と表示されたら、 Ctrl+C キーを押し、「 y 」と入力します。



|===




== コントローラモジュールを取り外します

[role="lead"]
コントローラモジュール内部のコンポーネントにアクセスするには、コントローラモジュールをシャーシから取り外す必要があります。

. 接地対策がまだの場合は、自身で適切に実施します。
. コントローラモジュールの電源装置のコードを電源から抜きます。
. ケーブルマネジメントデバイスに接続しているケーブルをまとめているフックとループストラップを緩め、システムケーブルと SFP をコントローラモジュールから外し（必要な場合）、どのケーブルが何に接続されていたかを記録します。
+
image::../media/drw_a320_cable_management_arms.png[DRW A320 ケーブル管理アーム]

+
ケーブルはケーブルマネジメントデバイスに収めたままにします。これにより、ケーブルマネジメントデバイスを取り付け直すときに、ケーブルを整理する必要がありません。

. ケーブルマネジメントデバイスをコントローラモジュールの右側と左側から取り外し、脇に置きます。
. コントローラモジュールをシャーシから取り外します。
+
image::../media/drw_a320_controller_remove_animated_gif.png[DRW A320 コントローラアニメーション GIF を削除します]

+
.. コントローラモジュールの両側にあるラッチ機構に人差し指をかけます。
.. ラッチ機構の上部にあるオレンジ色のタブを押し下げて、シャーシのラッチピンを解除します。


+
ラッチ機構のフックがほぼ垂直に位置し、シャーシピンから解除されている必要があります。

+
.. コントローラモジュールの側面を持てるように、コントローラモジュールをゆっくりと少し手前に引き出します。
.. コントローラモジュールを両手でシャーシからゆっくりと引き出し、平らで安定した場所に置きます。






== NVDIMM を交換します

[role="lead"]
NVDIMM を交換するには、エアダクトの上の NVDIMM マップラベルまたは NVDIMM の横の LED でコントローラモジュール内の NVDIMM の場所を確認してから、特定の手順に従って交換します。


NOTE: システムを停止すると、コンテンツのデステージ中に NVDIMM の LED が点滅します。デステージが完了すると LED は消灯します。

image::../media/drw_a320_nvdimm_replace_animated_gif.png[DRW A320 NVDIMM はアニメーション GIF に代わるものです]

. エアダクトを開き、コントローラモジュールのスロット 11 で NVDIMM の場所を確認します。
+

NOTE: NVDIMM の外観はシステム DIMM とは大きく異なります。

. NVDIMM を交換用コントローラモジュールに正しい向きで挿入できるように、ソケット内の NVDIMM の向きをメモします。
. NVDIMM の両側にある 2 つのツメをゆっくり押し開いて NVDIMM をスロットから外し、そのままスライドさせてソケットから取り出し、脇に置きます。
+

NOTE: NVDIMM 回路基板のコンポーネントに力が加わらないように、 NVDIMM の両端を慎重に持ちます。

. 交換用 NVDIMM を静電気防止用の梱包バッグから取り出し、 NVDIMM の端を持ってスロットに合わせます。
+
NVDIMM のピンの間にある切り欠きを、ソケットの突起と揃える必要があります。

. NVDIMM を取り付けるスロットの場所を確認します。
. NVDIMM をスロットに対して垂直に挿入します。
+
NVDIMM のスロットへの挿入にはある程度の力が必要です。簡単に挿入できない場合は、 NVDIMM をスロットに正しく合わせてから再度挿入してください。

+

NOTE: NVDIMM がスロットにまっすぐ差し込まれていることを目で確認してください。

. NVDIMM の両端のノッチにツメがかかるまで、 NVDIMM の上部を慎重にしっかり押し込みます。
. エアダクトを閉じます。




== コントローラモジュールを取り付けます

[role="lead"]
コントローラモジュールのコンポーネントを交換したら、コントローラモジュールをシャーシに再度取り付け、メンテナンスモードでブートする必要があります。

. コントローラモジュールの背面にあるエアダクトを閉じ、 PCIe カードにカバーを再度取り付けていない場合は、
. コントローラモジュールの端をシャーシの開口部に合わせ、コントローラモジュールをシステムに半分までそっと押し込みます。
+

NOTE: 指示があるまでコントローラモジュールをシャーシに完全に挿入しないでください。

. システムにアクセスして以降のセクションのタスクを実行できるように、管理ポートとコンソールポートのみをケーブル接続します。
+

NOTE: 残りのケーブルは、この手順の後半でコントローラモジュールに接続します。

. コントローラモジュールの再取り付けを完了します。
+
.. ラッチアームが引き出された位置で固定されていることを確認します。
.. ラッチアームを使用して、コントローラモジュールをシャーシベイの奥まで押し込みます。
.. ラッチ上部にあるオレンジ色のタブを押し下げます。
.. コントローラモジュールをシャーシの端と揃うまで、シャーシベイにそっと押し込みます。
+

NOTE: ラッチのアームがシャーシ内にスライドします。

+
コントローラモジュールは、シャーシに完全に装着されるとすぐにブートを開始します。

.. ラッチを外してコントローラモジュールを所定の位置に固定します。
.. 電源装置を再度ケーブル接続します。
.. ケーブルマネジメントデバイスをまだ取り付けていない場合は、取り付け直します。
.. Ctrl キーを押しながら C キーを押して ' 通常の起動プロセスを中断します






== 診断を実行します

[role="lead"]
システムの NVDIMM を交換したら、そのコンポーネントの診断テストを実行する必要があります。

診断を開始するには、システムに LOADER プロンプトが表示されている必要があります。

診断手順のコマンドは、すべてコンポーネントを交換するノードから実行します。

. 作業をするノードに LOADER プロンプトが表示されていない場合は、ノードをリブートします。「 system node halt -node node_name 」
+
コマンドを問題したら、システムが LOADER プロンプトで停止するまで待ちます。

. LOADER プロンプトで、システムレベルの診断用に特別に設計されたドライバ「 boot_diags 」にアクセスします
. 表示されたメニューから「 * Scan System * （システムのスキャン）」を選択して、診断テストの実行を有効にします。
. 表示されたメニューから * Test Memory * を選択します。
. 表示されたメニューから * NVDIMM Test * を選択します。
. 前述の手順の結果に応じて、次に進みます。
+
** テストに失敗した場合は、エラーを修正してからテストを再実行します。
** テストでエラーが報告されなかった場合は、メニューから Reboot を選択してシステムをリブートします。






== 診断実行後、コントローラモジュールを稼働状態に戻します

[role="lead"]
診断が完了したら、システムにケーブルを再接続してコントローラモジュールをギブバックし、自動ギブバックを再度有効にする必要があります。

. 必要に応じてシステムにケーブルを再接続します。
+
光ファイバケーブルを使用する場合は、メディアコンバータ（ QSFP または SFP ）を取り付け直してください（取り外した場合）。

. ストレージをギブバックしてノードを通常動作に戻します。「 storage failover giveback -ofnode impaired_node_name _
. 自動ギブバックを無効にした場合は、再度有効にします。「 storage failover modify -node local-auto-giveback true 」




== 障害のあるパーツをネットアップに返却します

[role="lead"]
部品を交換したあと、障害のある部品をネットアップに返却することができます。詳細については、キットに付属する RMA 指示書を参照してください。テクニカルサポートにお問い合わせください https://mysupport.netapp.com/site/global/dashboard["ネットアップサポート"]RMA 番号を確認する場合や、交換用手順にサポートが必要な場合は、日本国内サポート用電話番号：国内フリーダイヤル 0066-33-123-265 または 0066-33-821-274 （国際フリーフォン 800-800-80-800 も使用可能）までご連絡ください。
