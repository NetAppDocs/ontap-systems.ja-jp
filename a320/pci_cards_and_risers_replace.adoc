---
permalink: a320/pci-cards-and-risers-replace.html 
sidebar: sidebar 
keywords: aff, a320, aff a320, replace, pcie, card, disconnect, cable, card, sfp, qsfp, module, riser, reinstall, shut, down, controller, operation, diagnostic, complete, process, replace a pcie card, shut down the impaired controller, remove the controller module, replace a pcie card, install the controller module, restore the controller module to operation after running diagnostics, complete the replacement process 
summary: PCIe カードを交換するには、カードからケーブルを外し、 SFP モジュールと QSFP モジュールをカードから取り外してから、ライザーを取り付け直し、 SFP モジュールと QSFP モジュールを取り付けてから、カードをケーブル接続する必要があります。 
---
= PCIe カードを交換してください - AFF A320
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
PCIe カードを交換するには、カードからケーブルを外し、 SFP モジュールと QSFP モジュールをカードから取り外してから、ライザーを取り付け直し、 SFP モジュールと QSFP モジュールを取り付けてから、カードをケーブル接続する必要があります。

* この手順は、システムでサポートされるすべてのバージョンの ONTAP で使用できます
* システムのその他のコンポーネントがすべて正常に動作している必要があります。問題がある場合は、必ずテクニカルサポートにお問い合わせください。




== 手順 1 ：障害のあるコントローラをシャットダウンします

障害のあるコントローラをシャットダウンするには、コントローラのステータスを確認し、必要に応じて正常なコントローラが障害のあるコントローラストレージからデータを引き続き提供できるようにコントローラをテイクオーバーする必要があります。

.このタスクについて
* NetApp Storage Encryptionを使用している場合は、の手順に従ってMSIDをリセットしておく必要があります link:https://docs.netapp.com/us-en/ontap/encryption-at-rest/return-seds-unprotected-mode-task.html["SEDを非保護モードに戻します"]。
* SANシステムを使用している場合は、イベントメッセージを確認しておく必要があります  `cluster kernel-service show`)を参照してください。。 `cluster kernel-service show` コマンドは、ノード名、そのノードのクォーラムステータス、ノードの可用性ステータス、およびノードの動作ステータスを表示します。
+
各 SCSI ブレードプロセスは、クラスタ内の他のノードとクォーラムを構成している必要があります。交換を進める前に、すべての問題を解決しておく必要があります。

* ノードが 3 つ以上あるクラスタは、クォーラムを構成している必要があります。クラスタがクォーラムを構成していない場合、または正常なコントローラで適格性と正常性についてfalseと表示される場合は、障害のあるコントローラをシャットダウンする前に問題 を修正する必要があります。を参照してください link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["ノードをクラスタと同期します"^]。


.手順
. AutoSupport が有効になっている場合は、 AutoSupport メッセージを呼び出してケースの自動作成を抑制します。「 system node AutoSupport invoke -node * -type all -message MAINT=number_OF_hours_downh
+
次のAutoSupport メッセージは、ケースの自動作成を2時間停止します。 `cluster1:> system node autosupport invoke -node * -type all -message MAINT=2h`

. 正常なコントローラのコンソールから自動ギブバックを無効にします。 storage failover modify – node local-auto-giveback false
+

NOTE: 自動ギブバックを無効にしますか?_と表示されたら'y'を入力します

. 障害のあるコントローラに LOADER プロンプトを表示します。
+
[cols="1,2"]
|===
| 障害のあるコントローラの表示 | 作業 


 a| 
LOADER プロンプト
 a| 
コントローラモジュールの取り外しに進みます。



 a| 
ギブバックを待っています
 a| 
Ctrl キーを押しながら C キーを押し ' プロンプトが表示されたら y と入力します



 a| 
システムプロンプトまたはパスワードプロンプト
 a| 
正常なコントローラから障害のあるコントローラをテイクオーバーまたは停止します。「 storage failover takeover -ofnode impaired_node_name _

障害のあるコントローラに「 Waiting for giveback... 」と表示されたら、 Ctrl+C キーを押し、「 y 」と入力します。

|===




== 手順 2 ：コントローラモジュールを取り外す

コントローラモジュール内部のコンポーネントにアクセスするには、コントローラモジュールをシャーシから取り外す必要があります。

. 接地対策がまだの場合は、自身で適切に実施します。
. コントローラモジュールの電源装置のコードを電源から抜きます。
. ケーブルマネジメントデバイスに接続しているケーブルをまとめているフックとループストラップを緩め、システムケーブルと SFP をコントローラモジュールから外し（必要な場合）、どのケーブルが何に接続されていたかを記録します。
+
image::../media/drw_a320_controller_cable_unplug_animated_gif.png[DRW A320 コントローラケーブルプラグアニメーション GIF]

+
ケーブルはケーブルマネジメントデバイスに収めたままにします。これにより、ケーブルマネジメントデバイスを取り付け直すときに、ケーブルを整理する必要がありません。

. ケーブルマネジメントデバイスをコントローラモジュールの右側と左側から取り外し、脇に置きます。
. コントローラモジュールをシャーシから取り外します。
+
image::../media/drw_a320_controller_remove_animated_gif.png[DRW A320 コントローラアニメーション GIF を削除します]

+
.. コントローラモジュールの両側にあるラッチ機構に人差し指をかけます。
.. ラッチ機構の上部にあるオレンジ色のタブを押し下げて、シャーシのラッチピンを解除します。


+
ラッチ機構のフックがほぼ垂直に位置し、シャーシピンから解除されている必要があります。

+
.. コントローラモジュールの側面を持てるように、コントローラモジュールをゆっくりと少し手前に引き出します。
.. コントローラモジュールを両手でシャーシからゆっくりと引き出し、平らで安定した場所に置きます。






== 手順 3 ： PCIe カードを交換します

障害の発生した PCIe カードを含む PCIe ライザーをコントローラモジュールから取り外し、障害の発生した PCIe カードをライザーから取り外し、交換用 PCIe カードをライザーに取り付けてから、ライザーをコントローラモジュールに再度取り付ける必要があります。

image::../media/drw_a320_pci_card_replace_animated_gif.png[DRW A320 PCI カードはアニメーション GIF に代わるものです]

. PCIe ライザーのカバーの青色の取り付けネジを外してカバーを取り外します。カバーを手前にスライドさせて上に回転させ、コントローラモジュールから持ち上げて外し、脇に置きます。
. 障害のある PCIe カードが取り付けられているライザーを取り外します。
+
.. PCIe カード内の SFP モジュールまたは QSFP モジュールを取り外します。
.. ライザーモジュールの左側にある穴に人差し指を入れ、親指でライザーをつかみます。
.. ライザーを持ち上げてソケットから取り出し、脇に置きます。


. ライザー内のカードを交換します。
+
.. ライザーを安定した場所に置き、ライザーを裏返して PCIe カードを取り出せるようにします。
.. ソケットの両側で PCIe カードの下端のすぐ下に親指を置き、カードをそっと上に押してソケットから外します。
.. カードをスライドさせてライザーから取り出し、脇に置きます。
.. 交換用カードのベゼルをライザーの端に合わせ、カードの外側の端をライザーの左側にある位置合わせガイドに合わせます。
.. カードをそっとスライドさせ、カードコネクタとライザーソケットの位置が合ったらカードをソケットにゆっくりと押し込みます。


. ライザーをコントローラモジュールに再度取り付けます。
+
.. ライザーの前端がライザーベイの開口部の真上に来るように、ライザーを開口部に合わせます。
.. ライザーの下側にあるピンが背面ライザーベイの金属板の穴の真上に来るように、ライザーの後端の位置を合わせます。
.. ライザーを均等な力で真下に押してコントローラモジュールのソケットに装着します。
.. PCIe ライザーカバーをコントローラモジュールに再度取り付けます。






== 9 月 4 日：コントローラモジュールを取り付けます

コントローラモジュールのコンポーネントを交換したら、コントローラモジュールをシャーシに再度取り付け、メンテナンスモードでブートする必要があります。

. コントローラモジュールの背面にあるエアダクトを閉じ、 PCIe カードにカバーを再度取り付けていない場合は、
. コントローラモジュールの端をシャーシの開口部に合わせ、コントローラモジュールをシステムに半分までそっと押し込みます。
+
image::../media/drw_a320_controller_install_animated_gif.png[DRW A320 コントローラにアニメーション GIF をインストールします]

+

NOTE: 指示があるまでコントローラモジュールをシャーシに完全に挿入しないでください。

. システムにアクセスして以降のセクションのタスクを実行できるように、管理ポートとコンソールポートのみをケーブル接続します。
+

NOTE: 残りのケーブルは、この手順の後半でコントローラモジュールに接続します。

. コントローラモジュールの再取り付けを完了します。
+
.. ラッチアームが引き出された位置で固定されていることを確認します。
.. ラッチアームを使用して、コントローラモジュールをシャーシベイの奥まで押し込みます。
.. ラッチ上部にあるオレンジ色のタブを押し下げます。
.. コントローラモジュールをシャーシの端と揃うまで、シャーシベイにそっと押し込みます。
+

NOTE: ラッチのアームがシャーシ内にスライドします。

+
コントローラモジュールは、シャーシに完全に装着されるとすぐにブートを開始します。

.. ラッチを外してコントローラモジュールを所定の位置に固定します。
.. 電源装置を再度ケーブル接続します。
.. ケーブルマネジメントデバイスをまだ取り付けていない場合は、取り付け直します。
.. Ctrl キーを押しながら C キーを押して ' 通常の起動プロセスを中断します






== 手順 5 ：コントローラモジュールを動作状態に戻す

診断が完了したら、システムにケーブルを再接続してコントローラモジュールをギブバックし、自動ギブバックを再度有効にする必要があります。

. 必要に応じてシステムにケーブルを再接続します。
+
光ファイバケーブルを使用する場合は、メディアコンバータ（ QSFP または SFP ）を取り付け直してください（取り外した場合）。

. ストレージをギブバックして、コントローラを通常の動作に戻します。 storage failover giveback -ofnode impaired_node_name _`
. 自動ギブバックを無効にした場合は、再度有効にします。「 storage failover modify -node local-auto-giveback true 」




== 手順 6 ：障害が発生したパーツをネットアップに返却する

障害のある部品は、キットに付属する RMA 指示書に従ってネットアップに返却してください。を参照してください https://["パーツの返品と交換"] 詳細については、を参照してください。
