---
permalink: c190/bootmedia-replace.html 
sidebar: sidebar 
keywords: aff c190, locate, boot, media, controller, direction, replace 
summary: コントローラモジュールのブートメディアの場所を確認し、手順に従って交換する必要があります。 
---
= ブートメディアを交換してください - AFF C190
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ブートメディアを交換するには、障害のあるコントローラモジュールを取り外し、交換用ブートメディアを取り付けて、ブートイメージを USB フラッシュドライブに転送する必要があります。



== 手順 1 ：コントローラを取り外す

コントローラモジュール内部のコンポーネントにアクセスするには、まずコントローラモジュールをシステムから取り外し、続いてコントローラモジュールのカバーを外す必要があります。

.手順
. 接地対策がまだの場合は、自身で適切に実施します。
. ケーブルマネジメントデバイスに接続しているケーブルをまとめているフックとループストラップを緩め、システムケーブルと SFP をコントローラモジュールから外し（必要な場合）、どのケーブルが何に接続されていたかを記録します。
+
ケーブルはケーブルマネジメントデバイスに収めたままにします。これにより、ケーブルマネジメントデバイスを取り付け直すときに、ケーブルを整理する必要がありません。

. ケーブルマネジメントデバイスをコントローラモジュールの右側と左側から取り外し、脇に置きます。
+
image::../media/drw_25xx_cable_management_arm.png[DRW 25xx ケーブル管理アーム]

. カムハンドルのラッチをつかんで解除し、カムハンドルを最大限に開いてコントローラモジュールをミッドプレーンから離し、両手でコントローラモジュールをシャーシから外します。
+
image::../media/drw_2240_x_opening_cam_latch.png[DRW 2240 x オープンカムラッチ]

. コントローラモジュールを裏返し、平らで安定した場所に置きます。
. カバーを開くには、青いタブをスライドしてカバーを外し、カバーを上げて開きます。
+
image::../media/drw_2600_opening_pcm_cover.png[DRW 2600 オープニング PCM カバー]





== 手順 2 ：ブートメディアを交換します

コントローラモジュールのブートメディアの場所を確認し、手順に従って交換する必要があります。

. 次の図またはコントローラモジュールの FRU マップを使用して、ブートメディアの場所を確認します。
. ブートメディアケースの青いボタンを押してブートメディアをケースからリリースし、ブートメディアソケットからゆっくりと引き出します。
+

NOTE: ソケットやブートメディアが損傷する可能性があるため、ブートメディアをねじったり、真上に引き出したりしないでください。

. 交換用ブートメディアの端をブートメディアソケットに合わせ、ソケットにゆっくりと押し込みます。
. ブートメディアが正しい向きでソケットに完全に装着されたことを確認します。
+
必要に応じて、ブートメディアを取り外してソケットへの装着をやり直します。

. ブートメディアを押し下げて、ブートメディアケースの固定ボタンをはめ込みます。
. コントローラモジュールのカバーを閉じます。




== 手順 3 ：ブートイメージをブートメディアに転送します

イメージがインストールされた USB フラッシュドライブを使用して、交換用ブートメディアにシステムイメージをインストールできます。ただし ' この手順の実行中に 'var' ファイル・システムをリストアする必要があります

* FAT32 にフォーマットされた、 4GB 以上の容量の USB フラッシュドライブが必要です。
* 障害のあるコントローラが実行していたバージョンの ONTAP イメージのコピー。ネットアップサポートサイトの「 * Downloads * 」セクションから適切なイメージをダウンロードできます
+
** NVE が有効な場合は、ダウンロードボタンの指示に従って、 NetApp Volume Encryption を使用してイメージをダウンロードします。
** NVE が有効になっていない場合は、ダウンロードボタンの指示に従って、 NetApp Volume Encryption なしでイメージをダウンロードします。


* HA ペアのシステムの場合は、ネットワーク接続が必要です。
* スタンドアロンシステムの場合はネットワーク接続は必要ありませんが、 var ファイルシステムをリストアしたときに追加のリブートを実行する必要があります。


.手順
. コントローラモジュールの端をシャーシの開口部に合わせ、コントローラモジュールをシステムに半分までそっと押し込みます。
. ケーブルマネジメントデバイスを再び取り付け、必要に応じてシステムにケーブルを再接続します。
+
ケーブルを再接続する際は、メディアコンバータ（ SFP ）も取り付け直してください（メディアコンバータを取り外した場合）。

. USB フラッシュドライブをコントローラモジュールの USB スロットに挿入します。
+
USB フラッシュドライブは、 USB コンソールポートではなく、 USB デバイス用のラベルが付いたスロットに取り付けてください。

. コントローラモジュールをシステムに最後まで押し込み、カムハンドルの位置が USB フラッシュドライブに干渉していないことを確認します。カムハンドルを強く押し込んでコントローラモジュールを装着し、カムハンドルを閉じ、取り付けネジを締めます。
+
コントローラは、シャーシに完全に取り付けられるとすぐにブートを開始します。

. 「自動ブートを開始するときに Ctrl+C キーを押して中止 ... 」と表示されたら、ブートプロセスを中断して LOADER プロンプトで停止します
+
このメッセージが表示されない場合は、 Ctrl+C キーを押し、メンテナンスモードで起動するオプションを選択し、コントローラを停止して LOADER モードで起動します。

. リカバリイメージをブートします。
+
'*boot_recovery__ONTAP_image_name_.tgz *

+

NOTE: 「 image.tgz 」ファイルの名前が、「 boot_recovery 9_4.tgz 」のような image.tgz 以外のものである場合は、「 boot_recovery 」コマンドに異なるファイル名を含める必要があります。

+
システムがブートしてブートメニューが表示され、ブートイメージ名の入力を求められます。

. USB フラッシュドライブ上のブートイメージ名を入力します。
+
'*__ image_name_.tgz *

+
`image_name.tgz' がインストールされると ' 正常なコントローラからバックアップ構成 (var' ファイルシステム ) をリストアするように求めるプロンプトが表示されます

. var' ファイルシステムを復元します
+
[cols="1,2"]
|===
| システム構成 | 作業 


 a| 
ネットワーク接続
 a| 
.. バックアップ構成を復元するかどうかを確認するメッセージが表示されたら '*y*' を押します
.. 正常なコントローラを advanced 権限レベルに設定します。
+
「 * set -privilege advanced * 」のように指定します

.. バックアップのリストアコマンドを実行します。
+
*system node restore-backup -node local-target-address_impaired_node_name _*

.. コントローラを admin レベルに戻します。
+
'*set -privilege admin*

.. 復元された構成を使用するかどうかを確認するメッセージが表示されたら '*y*' を押します
.. コントローラの再起動を求めるプロンプトが表示されたら '*y*' を押します




 a| 
ネットワーク接続がありません
 a| 
.. バックアップ構成を復元するように求められたら '*n*' を押します
.. プロンプトが表示されたら、システムをリブートします。
.. 表示されたメニューから「 * Update flash from backup config * （ sync flash ）」オプションを選択します。
+
更新を続行するかどうかを確認するメッセージが表示されたら '*y*' を押します



|===
. 環境変数が正しく設定されていることを確認します。
+
.. コントローラに LOADER プロンプトを表示します。
+
ONTAP プロンプトから、「 system node halt -skip-lif-migration-before-shutdown true -ignore-quorum -warnings true -inhibit-takeover true 」コマンドを問題できます。

.. printenv コマンドを使用して ' 環境変数の設定を確認します
.. 環境変数が正しく設定されていない場合は 'setenv_environment_variable_name changed_value_' コマンドを使用して変更します
.. 'aveenv' コマンドを使用して変更を保存します
.. コントローラをリブートします。


. 次の手順は、システム構成によって異なります。
+
[cols="1,2"]
|===
| システムの構成 | 作業 


 a| 
スタンドアロン構成です
 a| 
コントローラのリブート後にシステムの使用を開始できます。



 a| 
HA ペア
 a| 
障害のあるコントローラに「 Waiting for giveback... 」というメッセージが表示されたら、正常なコントローラからギブバックを実行します。

.. 正常なコントローラからギブバックを実行します。
+
` * storage failover giveback -ofnode partner_node_name _ *

+
これにより、障害のあるコントローラのアグリゲートおよびボリュームの所有権を正常なコントローラから障害のあるコントローラに戻すプロセスが開始されます。

+
[NOTE]
====
ギブバックが拒否されている場合は、拒否を無効にすることを検討してください。

https://docs.netapp.com/us-en/ontap/high-availability/index.html["HAペアの管理"^]

====
.. 「 storage failover show 」 -giveback コマンドを使用して、ギブバック処理の進捗を監視します。
.. ギブバック処理が完了したら、「 storage failover show 」コマンドを使用して、 HA ペアが正常でテイクオーバーが可能であることを確認します。
.. 「 storage failover modify 」コマンドを使用して自動ギブバックを無効にした場合は、自動ギブバックをリストアします。


|===

