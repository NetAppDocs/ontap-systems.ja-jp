---
permalink: fas2600/controller-replace-system-config-restore-and-verify.html 
sidebar: sidebar 
keywords: fas2600, restore and verify the system configuration, verify and set the ha state of the controller module, run system-level diagnostics 
summary: ハードウェアの交換が完了してメンテナンスモードでブートしたら、交換用コントローラの下位のシステム構成を確認し、必要に応じてシステムを再設定します。 
---
= システム構成をリストアして確認します - FAS2600
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ハードウェアの交換が完了してメンテナンスモードでブートしたら、交換用コントローラの下位のシステム構成を確認し、必要に応じてシステムを再設定します。



== 手順 1 ：コントローラを交換したあとにシステム時間を設定して確認します

交換用コントローラモジュールの日付と時刻は、 HA ペアの正常なコントローラモジュール、またはスタンドアロン構成の信頼できるタイムサーバに照らして確認する必要があります。日付と時刻が一致しない場合は、時刻の違いによるクライアントの停止を防ぐために、交換用コントローラモジュールで日付と時刻をリセットする必要があります。

.このタスクについて
これらの手順のコマンドを正しいシステムに適用することが重要です。

* replacement _node は、この手順で障害ノードと交換した新しいノードです。
* healthy_node は、 _replacement _node の HA パートナーです。


.手順
. _replacement _node に LOADER プロンプトが表示されない場合は、システムを停止して LOADER プロンプトを表示します。
. _healthy_node で、システム時刻「 show date 」を確認します
+
日付と時刻は GMT で表示されます。

. LOADER プロンプトで、 _replacement node の日付と時刻を確認します。 'how date]
+
日付と時刻は GMT で表示されます。

. 必要に応じて、交換用ノードの日付を GMT で設定します。 'et date_mm/dd/yyyy_`
. 必要に応じて、交換用ノードの時刻を GMT で設定します。「 set time _hh ： mm ： ss_` 」
. LOADER プロンプトで、 _replacement _node の日付と時刻を確認します。 'how dat'
+
日付と時刻は GMT で表示されます。





== 手順 2 ：コントローラモジュールの HA 状態を確認して設定します

コントローラモジュールの「 HA 」状態を確認し、必要に応じてシステム構成に合わせて状態を更新する必要があります。

. 新しいコントローラモジュールのメンテナンスモードで ' すべてのコンポーネントが同じ HA 状態で表示されることを確認します
+
HA 状態はすべてのコンポーネントで同じになっているはずです。

. 表示されたコントローラモジュールのシステム状態がシステム構成と一致しない場合は、コントローラモジュールの HA 状態を「 ha-config modify controller ha-state 」に設定します
+
hA-state には、次のいずれかの値を指定できます。

+
** 「 HA 」
** 「 non-ha 」


. 表示されたコントローラモジュールのシステム状態がシステム構成と一致しない場合は、コントローラモジュールの HA 状態を「 ha-config modify controller ha-state 」に設定します
. 設定が変更されたことを確認します。「 ha-config show 」




== 手順 3 ：システムレベルの診断を実行します

コントローラを交換するたびに、特定のコンポーネントとサブシステムについて包括的な診断テストまたは集中的な診断テストを実行する必要があります。

診断手順のコマンドは、すべてコンポーネントを交換するコントローラから実行します。

. 対象となるコントローラが LOADER プロンプトに表示されていない場合は、コントローラをリブートします。「 halt
+
コマンドを問題したら、システムが LOADER プロンプトで停止するまで待ちます。

. LOADER プロンプトで、システムレベルの診断用に特別に設計されたドライバ「 boot_diags 」にアクセスします
+
ブート・プロセス中に 'Maintenance] モードのプロンプト（ *> ）が表示されるまで 'y とプロンプトを入力しても安全です

. コントローラモジュールで使用可能なデバイスを表示してメモします。 'diag device show -dev MB
+
コントローラモジュールのデバイスおよびポートとして、次のいくつかが表示されます。

+
** 「 bootmedia 」は、システム起動デバイスです。
** cna' は ' ネットワークまたはストレージ・デバイスに接続されていない統合型ネットワーク・アダプタまたはインタフェースです
** fcal は ' ファイバ・チャネル・ネットワークに接続されていないファイバ・チャネル・アービトレート型ループ・デバイスです
** 「 env 」はマザーボード環境です。
** 「 m 」はシステムメモリです。
** 「 nic 」はネットワーク・インターフェイス・カードです。
** 「 nvram 」は不揮発性 RAM です。
** 「 nvmem 」は、 NVRAM とシステムメモリの組み合わせです。
** 「 As 」は、ディスクシェルフに接続されていないシリアル接続 SCSI デバイスです。


. 必要に応じて診断を実行します。
+
[cols="1,2"]
|===
| 診断テストを実行する対象 | 作業 


 a| 
個々のコンポーネント
 a| 
.. ステータスログ「 `diag device clearstatus` 」を消去します
.. 選択したデバイスに対して実行可能なテストを表示します。「 diag device show -dev_name_`
+
_dev_name_ には、前の手順で特定したポートとデバイスのいずれかを指定できます。

.. 出力を確認し、必要に応じて、実行するテストのみを選択します。「 diag device modify -dev_name_-selection only
+
-selection only - デバイスに対して実行しないその他のテストをすべて無効にします。

.. 選択したテストを実行します： 'ldiag device run -dev_name_`
+
テストが完了すると、次のメッセージが表示されます。

+
[listing]
----
*> <SLDIAG:_ALL_TESTS_COMPLETED>
----
.. 失敗したテストがないことを確認します。 'lddiag device status -dev_name_-llong -state failed'
+
テストに失敗した場合は、プロンプトに戻ります。失敗した場合は、そのステータスがすべて表示されます。





 a| 
同時に複数のコンポーネント
 a| 
.. 前の手順の出力で有効なデバイスと無効なデバイスを確認し、同時に実行するデバイスを決定します。
.. デバイスに対する個々のテストを一覧表示します。 'lddiag device show -dev_name_`
.. 出力を確認し、必要に応じて、実行するテストのみを選択します。「 diag device modify -dev_name_-selection only
+
- selection only を指定すると、デバイスに対して実行しないその他のテストがすべて無効になります。

.. テストが変更されたことを確認します。 'lddiag device show'
.. 同時に実行するデバイスごとに上記の手順を繰り返します。
.. すべてのデバイスで診断を実行します： 'lddiag device run
+

NOTE: 診断の実行を開始した後は、エントリを追加または変更しないでください。

+
テストが完了すると、次のメッセージが表示されます。

+
[listing]
----
*> <SLDIAG:_ALL_TESTS_COMPLETED>
----
.. コントローラにハードウェアの問題がないことを確認します。「 sldiag device status -long-state failed. 」というメッセージが表示されます
+
テストに失敗した場合は、プロンプトに戻ります。失敗した場合は、そのステータスがすべて表示されます。



|===
. 前述の手順の結果に基づいて、次に進みます。
+
[cols="1,2"]
|===
| システムレベルの診断のテスト結果 | 作業 


 a| 
は失敗なしで完了しました
 a| 
.. ステータスログ「 `diag device clearstatus` 」を消去します
.. ログがクリアされたことを確認します。「 diag device status 」
+
次のデフォルトの応答が表示されます。

+
[listing]
----
SLDIAG: No log messages are present.
----
.. 保守モードを終了します :halt
+
LOADER プロンプトが表示されます。

+
これで、システムレベルの診断が完了しました。





 a| 
テストが失敗しました
 a| 
問題の原因を特定します

.. 保守モードを終了します :halt
.. クリーンシャットダウンを実行し、電源装置の接続を解除します。
.. システムレベルの診断を実行するための考慮事項をすべて確認するとともに、ケーブルがしっかりと接続されているか、ハードウェアコンポーネントがストレージシステムに適切に取り付けられているかを確認します。
.. 電源装置を再接続し、ストレージシステムの電源をオンにします。
.. システムレベルの診断テストを再実行します。


|===

