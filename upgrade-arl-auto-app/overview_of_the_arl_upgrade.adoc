---
sidebar: sidebar 
permalink: upgrade-arl-auto-app/overview_of_the_arl_upgrade.html 
keywords: overview, arl, upgrade, owner, controller, hardware 
summary: ARL を使用してノードをアップグレードする前に、手順の動作について理解しておく必要があります。 
---
= ARL アップグレードの概要
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ARL を使用してノードをアップグレードする前に、手順の動作について理解しておく必要があります。このドキュメントでは、手順をいくつかの段階に分けて説明します。

手順では、交換用コントローラハードウェアを使用して元のコントローラハードウェアを一度に 1 台ずつアップグレードし、 HA ペア構成を利用してルート以外のアグリゲートの所有権を切り替えます。すべてのルート以外のアグリゲートで、アップグレード後の正しいノードである最終デスティネーションに到達するために、 2 つの再配置を実行する必要があります。

各アグリゲートにはホーム所有者と現在の所有者があります。ホーム所有者はアグリゲートの実際の所有者であり、現在の所有者は一時的な所有者です。

[cols="35,65"]
|===
| 段階 | 手順 


| ステージ 1 ：アップグレードの準備  a| 
. 事前確認を実行して、処理が実行可能であることを確認します。
. 事前確認が失敗した場合にアグリゲートの所有権を修正
. クラスタベースライセンスキーを入力します。
. ストレージ暗号化の IP アドレスを取得します。
. KMIP サーバを使用して認証を管理します。
. オンボードキーマネージャ（ OKM ）を使用してストレージ暗号化を管理します。
. SnapMirror 関係を休止します（オプション）。


ステージ 1 終了時のアグリゲートの所有権：

* node1 は、 node1 アグリゲートのホーム所有者と現在の所有者です。
* node2 には、 node2 アグリゲートのホーム所有者と現在の所有者を指定します。




| ステージ 2 ：ノード 1 の再配置と撤去  a| 
. ルート以外のアグリゲートを node1 から node2 に再配置します。
. ノード 1 が所有する SAN 以外のデータ LIF を node2 に再配置します。
. 障害が発生したアグリゲートを再配置するか、
. ノード 1 を撤去
. netbooting を準備します（オプション）。


ステージ 2 終了時のアグリゲートの所有権：

* node2 には、 node1 アグリゲートの現在の所有者を指定します。
* node2 には、 node2 アグリゲートのホーム所有者と現在の所有者を指定します。




| ステージ 3 ：ノード 3 をインストールしてブートします  a| 
. node3 をインストールしてブートします。
. FC または（統合ネットワークアダプタ）の CNA 構成を設定します。
. FC ポートを設定
. UTA / UTA2 ポートを確認して設定してください。
. ノード 3 が正常にインストールされていることを確認
. ノード 3 のネットワーク設定をリストアします。
. ノード 1 で所有している SAN 以外のデータ LIF をノード 2 からノード 3 に移動します。
. node1 で所有されているルート以外のアグリゲートを node2 から node3 に再配置します。


ステージ 3 終了時のアグリゲートの所有権：

* node3 は、 node1 アグリゲートのホームの所有者であること、および現在の所有者であること。
* node2 には、 node2 アグリゲートのホーム所有者と現在の所有者を指定します。




| ステージ 4 ： node2 の再配置と撤去  a| 
. ルート以外のアグリゲートを node2 から node3 に再配置します。
. node2 に所有されている SAN 以外のデータ LIF をノード 3 に再配置します。
. ノード 2 を撤去


ステージ 4 終了時のアグリゲートの所有権：

* node3 は、 node1 に属していたアグリゲートのホーム所有者および現在の所有者です。
* node2 には、 node2 アグリゲートのホーム所有者を指定します。
* node3 は、 node2 アグリゲートの現在の所有者です。




| ステージ 5 ：ノード 4 をインストールしてブートします  a| 
. ノード 4 をインストールしてブートします。
. ノード 4 で FC または CNA の設定を行います。
. FC ポートを設定
. UTA / UTA2 ポートを確認して設定してください。
. ノード 4 が正常にインストールされていることを確認
. ノード 4 のネットワーク構成をリストアします
. node2 によって所有されている SAN 以外のデータ LIF を node3 から node4 に再配置し、 node4 にある SAN LIF を確認します。


ステージ 5 終了時のアグリゲートの所有権：

* node3 は、 node1 に属していたアグリゲートのホーム所有者および現在の所有者です。
* node4 は、 node2 に属していたアグリゲートのホーム所有者および現在の所有者です。




| ステージ 6 ：アップグレードを完了する  a| 
. システムが正しく設定されていることを確認します。
. 新しいコントローラモジュールで Storage Encryption をセットアップします。
. 新しいコントロールモジュールで NetApp Volume Encryption をセットアップします。
. 古いシステムの運用を停止
. 必要に応じて NetApp SnapMirror の処理を再開


|===